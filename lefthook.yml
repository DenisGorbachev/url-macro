assert_lefthook_installed: true
pre-commit:
  parallel: true
  commands:
    gen:readme:
      run: |
        set -eu
        mise run gen:readme
        # README.md may not be created if `mise run gen:readme` is a stub
        if [ -f README.md ]; then
          # run rumdl because README.md has changed
          rumdl fmt README.md
          # add README.md manually instead of using `stage_fixed` because it may not have been staged
          git add README.md
        fi
    fix:
      run: mise run fix
      stage_fixed: true
      # `files` is needed for `stage_fixed` (by default, `stage_fixed` uses `{staged_files}`, but fmt may modify files which haven't been staged)
      files: git diff --name-only HEAD
    test:
      run: mise run test
commit-msg:
  commands:
    commitlint:
      run: mise run commitlint -- --edit "$1"
